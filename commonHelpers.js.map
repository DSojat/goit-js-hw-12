{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api';\n\nexport const limitPage = 15;\nexport let page = 1;\nlet oldName = '';\n\nexport default async function getGallerySearch(searchImageName) {\n  const searchParams = new URLSearchParams({\n    key: '42608378-1c88fd965c25ed4d8c49bb63d',\n    q: searchImageName,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: limitPage,\n    page: page,\n  });\n  try {\n    if (searchImageName !== oldName) {\n      page = 1;\n      oldName = searchImageName;\n    }\n    const response = await axios.get(`?${searchParams}`);\n    return response.data;\n  } catch {\n    error => alert(error);\n  }\n}\n\nexport async function nextPage(searchImageName) {\n  page += 1;\n  const response = await getGallerySearch(searchImageName);\n  return response;\n}\n","const gallery = document.querySelector('.gallery-list');\nconst gallerySection = document.querySelector('.gallery-section');\nconst loadButton = document.querySelector('.load-btn');\n\nexport function galleryLoaderToggle() {\n  const loader = document.querySelector('.loader');\n  if (loader) {\n    loader.remove();\n  } else {\n    gallerySection.insertAdjacentHTML(\n      'beforeend',\n      '<span class=\"loader\"></span>'\n    );\n  }\n}\n\nexport default function galleryAdd(array) {\n  const markup = array\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `\n    <li class=\"gallery-item\">\n      <div class=\"gallery-image-box\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n        </a>\n      </div>\n      <div class=\"gallery-stats\">\n        <ul>\n          Likes\n          <li>${likes}</li>\n        </ul>\n        <ul>\n          Views\n          <li>${views}</li>\n        </ul>\n        <ul>\n          Comments\n          <li>${comments}</li>\n        </ul>\n        <ul>\n          Downloads\n          <li>${downloads}</li>\n        </ul>\n      </div>\n    </li>\n        `\n    )\n    .join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n}\n","// Описаний у документації\nimport iziToast from 'izitoast';\n// Додатковий імпорт стилів\nimport 'izitoast/dist/css/iziToast.min.css';\n\niziToast.settings({\n  messageSize: '16',\n  messageLineHeight: '24',\n  maxWidth: 432,\n  theme: 'dark',\n  position: 'topRight',\n  iconUrl: './img/x-octagon.svg',\n});\n\n// Описаний у документації\nimport SimpleLightbox from 'simplelightbox';\n// Додатковий імпорт стилів\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport getGallerySearch from './js/pixabay-api';\nimport { nextPage } from './js/pixabay-api';\nimport { limitPage } from './js/pixabay-api';\nimport { page } from './js/pixabay-api';\nimport galleryAdd from './js/render-functions';\nimport { galleryLoaderToggle } from './js/render-functions';\n\nconst searchForm = document.querySelector('.search-form');\nconst gallery = document.querySelector('.gallery-list');\nconst loadButton = document.querySelector('.load-btn');\nlet searchImageName = '';\nconst instanceGallery = new SimpleLightbox('.gallery-list a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nfunction renderGallery(hits, totalHits) {\n  const totalPages = Math.ceil(totalHits / limitPage);\n  galleryLoaderToggle();\n  galleryAdd(hits);\n  instanceGallery.refresh();\n  if (page >= totalPages) {\n    return iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results\",\n      iconUrl: null,\n      theme: 'light',\n    });\n  }\n  loadButton.classList.remove('visually-hidden');\n}\n\nfunction scrollGallery() {\n  const elem = document.querySelector('.gallery-item');\n  const { height } = elem.getBoundingClientRect();\n  window.scrollBy({\n    top: height * 2,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n\nsearchForm.addEventListener('submit', event => {\n  event.preventDefault();\n  if (!loadButton.classList.contains('visually-hidden')) {\n    loadButton.classList.add('visually-hidden');\n  }\n  searchImageName = searchForm.elements.search.value.trim();\n\n  if (searchImageName) {\n    gallery.innerHTML = '';\n    galleryLoaderToggle();\n    getGallerySearch(searchImageName).then(({ hits, totalHits }) => {\n      if (hits.length === 0) {\n        gallery.innerHTML = '';\n        galleryLoaderToggle();\n        iziToast.show({\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n          backgroundColor: '#EF4040',\n        });\n      } else {\n        renderGallery(hits);\n        scrollGallery();\n      }\n    });\n    searchForm.reset();\n  } else {\n    gallery.innerHTML = '';\n  }\n});\n\nloadButton.addEventListener('click', event => {\n  loadButton.classList.add('visually-hidden');\n  galleryLoaderToggle();\n  nextPage(searchImageName).then(({ hits, totalHits }) => {\n    renderGallery(hits, totalHits);\n    scrollGallery();\n  });\n});\n"],"names":["axios","limitPage","page","oldName","getGallerySearch","searchImageName","searchParams","nextPage","gallery","gallerySection","galleryLoaderToggle","loader","galleryAdd","array","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","iziToast","searchForm","loadButton","instanceGallery","SimpleLightbox","renderGallery","hits","totalHits","totalPages","scrollGallery","elem","height","event"],"mappings":"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"}